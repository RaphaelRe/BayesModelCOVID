A Bayesian hierarchical approach to account for reporting uncertainty, variants of concern and vaccination coverage when estimating the effects of non-pharmaceutical interventions on the spread of infectious disease
-------------------------------------------------------------------------------

**Online material**

This repo contains 4 directories:
* `application`
* `data `
- `model`
* `simulation_study`


### application
Contains the files to fit the model to the real data:
* `fit_model_europe.py`: Main file to run the model on 20 European countries
* `prepare_data.R`: Script to build the main data frame for the application. Downloads data, defines NPIs and brings everything together
* `estimate_new_mutants.R`: File which was used to estimate the prevalence of the variants of concern
* `calculate_weighted_ifr.R`: File which was used to calculate the IFR


### data
Folder contains the used data. These are:
- All time-shifting distributions
- The IFR as generated by `calculate_weighted_ifr.R`
- Prevalence of variants of concern as calculated by `estimate_new_mutants.R`
- Data for the application (generated by `prepare_data.R`) 
- Subfolder `simulated_data` with 20 simulated datasets generated by`simulate_data_dynamic.R`


### model
The MCMC sampler which is used in the application and simulation study.


### simulation_study
Contains all files for the simulation study:
* `fit_model_simulation_study.py`: Main fail to fit the model to the simulation study
* `simulate_data_dynamic.R`: Script to simulate the data for the simulation study


## Run the model on data
To run the model run the file
- `fit_model_simulation_study.py` (in the `simulation_study` directory)
- `fit_model_europe.py` (in the `application` directory)

Note that the calculation time and resources vary depending on the length of the chains, number of sampled chains and used cores.
The simulation study parallelizes over the number of used datasets and runs the chains sequentially. For example one can use 20 cores for 20 datasets.
The application parallelizes the calculation over the number of chains. For example, one can use 8 cores for 8 chains.
